rules:
  # TERM LIMITS - Critical
  - id: term_limit_perpetual
    type: confidentiality_term
    pattern: '\b(?:perpetual|indefinite|no\s+expir(?:ation|y)|without\s+(?:time\s+)?limit)\b'
    severity: critical
    action: delete
    explanation: "Remove perpetual/indefinite confidentiality terms"

  - id: term_limit_insert_18mo
    type: confidentiality_term
    pattern: 'obligations?\s+(?:of|under)\s+this\s+Agreement\s+shall\s+(?:survive|continue|remain)'
    replacement: 'obligations of the parties under this Agreement shall survive for a period of eighteen (18) months following the date hereof'
    severity: critical
    action: replace
    explanation: "Add 18-month term limit"

  - id: term_limit_expiration
    type: confidentiality_term
    pattern: 'agreement\s+shall\s+(?:expire|terminate|end)(?!\s+eighteen)'
    addition: 'This Agreement shall expire eighteen (18) months from the date of this Agreement.'
    severity: critical
    action: add_after
    explanation: "Add explicit 18-month expiration"

  # NEW CRITICAL PATTERN - Found in 14 training instances (Made more flexible)
  - id: term_limit_specific_years_to_18mo
    type: confidentiality_term
    pattern: '(?:two\s*(?:\(\s*2\s*\))?\s*years?|2\s+years?|three\s*(?:\(\s*3\s*\))?\s*years?|24\s+months?|twenty[\s\-]?four\s+months?|period\s+of\s+(?:two|2|three|3)\s+years?)'
    replacement: 'eighteen (18) months'
    severity: critical
    action: replace
    explanation: "Standardize all multi-year terms to eighteen (18) months format"

  # CATCH-ALL for any year duration (fallback pattern)
  - id: term_limit_any_years_to_18mo
    type: confidentiality_term
    pattern: '(?:for\s+a\s+period\s+of|shall\s+(?:survive|remain|continue)\s+for|term\s+of|duration\s+of)\s+(?:one|two|three|four|five|\d+)\s+(?:\(\d+\)\s+)?years?'
    replacement: 'for a period of eighteen (18) months'
    severity: critical
    action: replace
    explanation: "Standardize any year-based term to 18 months"

  # GOVERNING LAW - Critical (Enhanced with full boilerplate from training data)
  - id: governing_law_change_delaware
    type: governing_law
    pattern: '(?:governed|construed|interpreted)\s+(?:by|in\s+accordance\s+with)\s+(?:the\s+)?laws?\s+of\s+(?:the\s+)?(?:State\s+of\s+)?(?!Delaware)([A-Za-z]+(?:\s+[A-Za-z]+)?)'
    replacement: 'governed by the internal laws of the State of Delaware, without giving effect to Delaware principles or rules of conflict of laws'
    severity: critical
    action: replace
    explanation: "Change governing law to Delaware with conflict of laws disclaimer"

  # BROADER GOVERNING LAW - Catch more variations
  - id: governing_law_any_state
    type: governing_law
    pattern: '(?:law|laws)\s+of\s+(?:the\s+State\s+of\s+)?(?:Texas|California|New York|Florida|Illinois|Ontario|Canada)'
    replacement: 'laws of the State of Delaware'
    severity: critical
    action: replace
    explanation: "Change any state law reference to Delaware"

  # ENTITY NAME STANDARDIZATION - Critical (NEW - Found throughout training data)
  - id: entity_name_generic_to_edgewater
    type: entity_name
    pattern: '\b(?:The\s+Funds?|Buyer|The\s+undersigned|equity)\b'
    replacement: 'Edgewater Services, LLC'
    severity: moderate
    action: replace
    explanation: "Replace generic party names with Edgewater Services, LLC"

  - id: entity_name_with_designation
    type: entity_name
    pattern: 'Edgewater Services, LLC(?!\s*,\s*a\s+Delaware\s+(?:limited\s+liability\s+company|LLC))'
    replacement: 'Edgewater Services, LLC, a Delaware LLC'
    severity: low
    action: replace
    context_required: 'first.*occurrence|party.*defined'
    explanation: "Add Delaware LLC designation to entity name"

  # DOCUMENT RETENTION - Critical
  - id: retention_carveout
    type: document_retention
    pattern: '(?:return|destroy).*?(?:all|any).*?(?:Confidential\s+)?(?:Information|documents|materials)(?!.*?(?:legal|regulatory|archival))'
    addition: 'Notwithstanding the foregoing, Recipient may retain copies of Confidential Information as necessary for legal, regulatory, or archival purposes, or as required by regulation, or legal process, provided such retained information remains subject to the confidentiality obligations herein.'
    severity: critical
    action: add_after
    explanation: "Add legal/regulatory/archival retention carveout"

  - id: return_destroy_option
    type: document_retention
    pattern: '\b(?:shall|must)\s+return\b(?!.*?or\s+destroy)'
    replacement: 'shall, upon request, either return or destroy'
    severity: moderate
    action: replace
    explanation: "Allow destruction option for confidential materials"

  # NEW CRITICAL - Disclosure Practical Permissibility (Found in 7 training instances)
  - id: disclosure_practical_permissibility
    type: document_retention
    pattern: '(?:provide|give|deliver)\s+(?:prompt|prior|advance)?\s*(?:notice|notification)'
    addition: ', to the extent legally and practically permissible,'
    severity: critical
    action: add_inline
    context_required: '(?:required|compelled|obligated).*?(?:law|regulation|legal\s+process)'
    explanation: "Add practical permissibility qualifier to disclosure notice requirements"

  # REPRESENTATIVES DEFINITION EXPANSION - Critical (NEW - Found in 12 training instances)
  - id: representatives_definition_expansion
    type: representatives_definition
    pattern: '(?:its|their|your)\s+(?:directors?,?\s*officers?,?\s*(?:and\s+)?employees?|advisors?|representatives?)'
    replacement: 'directors, officers, advisors, employees, financing sources, consultants, accountants and attorneys (collectively, "Representatives")'
    severity: critical
    action: replace
    explanation: "Expand Representatives definition with comprehensive list"

  - id: equity_financing_consent_carveout
    type: representatives_definition
    pattern: 'financing\s+sources?(?!.*?prior\s+written\s+consent)'
    addition: ' (provided that Recipient shall obtain Disclosing Party''s prior written consent before disclosing Confidential Information to Recipient''s equity financing sources)'
    severity: critical
    action: add_after
    context_required: 'Representatives'
    explanation: "Add equity financing consent requirement"

  # NON-SOLICIT CARVEOUTS - Critical
  - id: non_solicit_carveouts
    type: employee_solicitation
    pattern: '(?:shall\s+not|will\s+not|agree\s+not\s+to)\s+(?:directly\s+or\s+indirectly\s+)?(?:solicit|hire|employ).*?(?:employee|personnel)(?!.*?(?:general\s+advertisement|employee-initiated|prior\s+(?:employment\s+)?discussion|terminated))'
    addition: |
      Nothing herein shall prevent Recipient from hiring such persons who: (i) respond to general advertisements or recruiting efforts not specifically directed at the Disclosing Party's employees; (ii) initiate discussions with Recipient without any direct or indirect solicitation; (iii) had prior employment discussions with Recipient before receiving Confidential Information; or (iv) were terminated by the Disclosing Party prior to commencement of discussions with Recipient.
    severity: critical
    action: add_after
    explanation: "Add standard non-solicit carveouts"

  # NEW - Non-Solicitation Scope Narrowing (Found in 9 training instances)
  - id: non_solicit_scope_to_key_executives
    type: employee_solicitation
    pattern: '\bany\s+(?:employee|person|personnel)\b'
    replacement: 'any key executive'
    severity: moderate
    action: replace
    context_required: 'solicit|hire|employ'
    explanation: "Narrow non-solicitation scope to key executives only"

  # AFFILIATE REMOVAL - Moderate (Context-sensitive)
  - id: remove_affiliate_references
    type: affiliate_clause
    pattern: '\b(?:and|or|including)\s+(?:its|our|their)\s+affiliates?\b'
    severity: moderate
    action: delete
    context_required: '(?<!portfolio|investment|fund)'
    explanation: "Remove affiliate references (except in PE context)"

  - id: remove_affiliate_standalone
    type: affiliate_clause
    pattern: ',?\s*(?:subsidiaries|affiliates|parents|related\s+entities),?\s*'
    severity: moderate
    action: delete
    context_required: '(?<!portfolio|investment|fund)'
    explanation: "Remove affiliate/subsidiary references (except in PE context)"

  # NEW - Portfolio Company Carveout for PE Context (Found in multiple training instances)
  - id: portfolio_company_affiliate_carveout
    type: affiliate_clause
    pattern: '(?:affiliates?|subsidiaries).*?(?:shall|will).*?(?:confidential|obligations?|representatives?)'
    addition: |
      None of Recipient's affiliates (including any investment fund managed by Recipient or its affiliate or any portfolio company of any such investment fund) shall be deemed to be one of Recipient's Representatives or have any obligations hereunder unless such person or entity actually receives Confidential Information.
    severity: moderate
    action: add_after
    context_required: 'investment|fund|private\s+equity|portfolio'
    explanation: "Add portfolio company carveout for PE firm context"

  # LEGAL MODIFIERS - Moderate
  - id: best_efforts_to_commercially_reasonable
    type: legal_modifier
    pattern: '\bbest\s+efforts?\b'
    replacement: 'commercially reasonable efforts'
    severity: moderate
    action: replace
    explanation: "Change 'best efforts' to 'commercially reasonable efforts'"

  - id: remove_sole_discretion
    type: legal_modifier
    pattern: '\b(?:sole|absolute)\s+discretion\b'
    replacement: 'reasonable discretion'
    severity: moderate
    action: replace
    explanation: "Moderate discretion language"

  # COMPETITION SAFE HARBOR - Critical (Enhanced with detailed language from training data)
  - id: competition_disclaimer
    type: competition_clause
    pattern: '(?:Confidential\s+Information|this\s+Agreement)(?!.*?(?:will\s+not|shall\s+not).*?(?:prevent|preclude|restrict).*?(?:business|compet))'
    addition: |
      Notwithstanding anything contained herein to the contrary, the Company acknowledges that Recipient and its affiliated companies may now and in the future be direct competitors of the Company and that Recipient's receipt and possession of Confidential Information will not, in and of itself, prevent or restrict Recipient in any way from carrying on its business in the ordinary course, including without limitation, making investments in or acquisitions of businesses similar to or competitive with Disclosing Party, making quotes or bids in direct competition with the Company, provided that Recipient complies strictly with the obligations of this Agreement.
    severity: critical
    action: add_after
    context_required: 'confidential.*information.*disclosed'
    explanation: "Add comprehensive competition safe harbor language"

  # INJUNCTIVE RELIEF MODIFICATION - Moderate
  - id: injunctive_relief_balance
    type: remedies
    pattern: '(?:entitled|right)\s+to\s+(?:seek\s+)?injunctive\s+relief(?!.*?upon.*?(?:final|binding).*?determination)'
    addition: ', upon a final binding determination of a court of competent jurisdiction,'
    severity: moderate
    action: add_inline
    explanation: "Require court determination for injunctive relief"

  # REPRESENTATIONS AND WARRANTIES - Moderate
  - id: remove_accuracy_representation
    type: representations
    pattern: '(?:represent|warrant).*?(?:accuracy|completeness|correctness).*?(?:Information|materials)'
    severity: moderate
    action: delete
    explanation: "Remove representations about information accuracy"

  - id: remove_ownership_representation
    type: representations
    pattern: '(?:represent|warrant).*?(?:own|ownership|right|title).*?(?:Information|materials)'
    severity: moderate
    action: delete
    explanation: "Remove ownership representations"

  # INDEMNIFICATION - High
  - id: remove_indemnification
    type: indemnification
    pattern: '(?:shall\s+)?(?:indemnify|hold\s+harmless).*?(?:from|against).*?(?:claim|loss|damage|liability)'
    severity: high
    action: delete
    explanation: "Remove indemnification clauses"

  # BROKER/COMMISSION LANGUAGE - High
  - id: remove_broker_commission
    type: broker_clause
    pattern: '(?:Broker|commission|brokerage).*?(?:paid|due|entitled).*?(?:at\s+closing|upon\s+sale)'
    severity: high
    action: delete
    explanation: "Remove broker/commission language"

  # ASSIGNMENT RESTRICTIONS - Moderate
  - id: allow_assignment
    type: assignment
    pattern: 'may\s+not\s+(?:be\s+)?assign(?:ed)?.*?without.*?(?:prior\s+)?(?:written\s+)?consent'
    replacement: 'may be assigned to affiliates or in connection with a merger, acquisition, or sale of all or substantially all assets'
    severity: moderate
    action: replace
    explanation: "Allow assignment in M&A situations"

  # JURISDICTION/VENUE - Moderate
  - id: remove_specific_venue
    type: jurisdiction
    pattern: '(?:exclusive\s+)?(?:jurisdiction|venue).*?(?:court|County|District)'
    severity: moderate
    action: delete
    explanation: "Remove specific venue requirements"

  # WRITTEN REQUEST FOR RETURN - Moderate
  - id: require_written_request
    type: document_retention
    pattern: '(?:shall|must|will)\s+(?:immediately\s+)?(?:return|destroy)(?!.*?(?:upon|following)\s+(?:written\s+)?request)'
    replacement: 'shall, upon written request,'
    severity: moderate
    action: add_inline
    explanation: "Require written request for return/destruction"
